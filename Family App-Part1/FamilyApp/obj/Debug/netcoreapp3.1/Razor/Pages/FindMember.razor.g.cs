#pragma checksum "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "a0b6b8aa18b41b127f03d37223c068e4b281c5a7"
// <auto-generated/>
#pragma warning disable 1591
namespace FamilyApp.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\_Imports.razor"
using FamilyApp;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\_Imports.razor"
using FamilyApp.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\_Imports.razor"
using Syncfusion.Blazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\_Imports.razor"
using Syncfusion.Blazor.Calendars;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
using FamilyApp.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
using FamilyApp.Data;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
using Syncfusion.Blazor.Navigations;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
           [Authorize]

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/SeeAdult")]
    public partial class FindMember : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.AddMarkupContent(0, "<div class=\"container mw-100 p-3 text-center blue\"><h3>In this part you can find family members by name or lastname</h3></div>\r\n");
            __builder.OpenComponent<Microsoft.AspNetCore.Components.Authorization.AuthorizeView>(1);
            __builder.AddAttribute(2, "Policy", "MustBeAdmin");
            __builder.AddAttribute(3, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment<Microsoft.AspNetCore.Components.Authorization.AuthenticationState>)((context) => (__builder2) => {
                __builder2.AddMarkupContent(4, "\r\n    ");
                __builder2.AddMarkupContent(5, "<div class=\"mw-100 p-3 text-center\" style=\"background-color: #7abaff\"><h3> and remove family members</h3></div>\r\n");
            }
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(6, "\r\n");
            __builder.OpenElement(7, "div");
            __builder.AddAttribute(8, "class", "mx-auto text-center my-3 border border-info rounded");
            __builder.AddMarkupContent(9, "\r\n");
            __builder.OpenElement(10, "p");
            __builder.AddAttribute(11, "class", "mt-2");
            __builder.AddMarkupContent(12, "Enter name or lastname:\r\n            <br>\r\n            ");
            __builder.OpenElement(13, "input");
            __builder.AddAttribute(14, "value", Microsoft.AspNetCore.Components.BindConverter.FormatValue(
#nullable restore
#line 19 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                          byName

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(15, "onchange", Microsoft.AspNetCore.Components.EventCallback.Factory.CreateBinder(this, __value => byName = __value, byName));
            __builder.SetUpdatesAttributeName("value");
            __builder.CloseElement();
            __builder.AddMarkupContent(16, "\r\n        ");
            __builder.CloseElement();
            __builder.AddMarkupContent(17, "\r\n");
            __builder.OpenElement(18, "p");
            __builder.AddAttribute(19, "class", "actions");
            __builder.AddMarkupContent(20, "\r\n                ");
            __builder.OpenElement(21, "button");
            __builder.AddAttribute(22, "class", "btn btn-outline-dark button-p");
            __builder.AddAttribute(23, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 22 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                                                                          () => FilterByName(byName)

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(24, "Filter");
            __builder.CloseElement();
            __builder.AddMarkupContent(25, "\r\n            ");
            __builder.CloseElement();
            __builder.AddMarkupContent(26, "\r\n");
            __builder.OpenElement(27, "p");
            __builder.AddAttribute(28, "style", "color:#dc3545");
            __builder.AddContent(29, 
#nullable restore
#line 24 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                          errorMessage

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(30, "\r\n");
            __builder.CloseElement();
            __builder.AddMarkupContent(31, "\r\n");
#nullable restore
#line 26 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
 if (filteredAdults== null&&filteredChildren==null) {
   
} 
else if (!filteredAdults.Any()&&!filteredChildren.Any()) {

#line default
#line hidden
#nullable disable
            __builder.AddContent(32, "    ");
            __builder.AddMarkupContent(33, "<p>\r\n        <em>No member exists with given name.</em>\r\n    </p>\r\n");
#nullable restore
#line 33 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
}
else
{

#line default
#line hidden
#nullable disable
            __builder.AddContent(34, "    ");
            __builder.OpenElement(35, "table");
            __builder.AddAttribute(36, "class", "table");
            __builder.AddMarkupContent(37, "\r\n        ");
            __builder.AddMarkupContent(38, "<thead>\r\n        <tr>\r\n            <th>Name</th>\r\n            <th>Lastname</th>\r\n            <th>Age</th>\r\n            <th>Gender</th>\r\n            <th>Family</th>\r\n   \r\n        </tr>\r\n        </thead>\r\n        ");
            __builder.OpenElement(39, "tbody");
            __builder.AddMarkupContent(40, "\r\n");
#nullable restore
#line 48 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
         foreach (var adult in filteredAdults)
        {

#line default
#line hidden
#nullable disable
            __builder.AddContent(41, "            ");
            __builder.OpenElement(42, "tr");
            __builder.AddMarkupContent(43, "\r\n                ");
            __builder.OpenElement(44, "td");
            __builder.AddContent(45, 
#nullable restore
#line 51 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                     adult.FirstName

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(46, "\r\n                ");
            __builder.OpenElement(47, "td");
            __builder.AddContent(48, 
#nullable restore
#line 52 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                     adult.LastName

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(49, "\r\n                ");
            __builder.OpenElement(50, "td");
            __builder.AddContent(51, 
#nullable restore
#line 53 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                     adult.Age

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(52, "\r\n                ");
            __builder.OpenElement(53, "td");
            __builder.AddContent(54, 
#nullable restore
#line 54 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                     adult.Sex

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(55, "\r\n                ");
            __builder.OpenElement(56, "td");
            __builder.OpenElement(57, "button");
            __builder.AddAttribute(58, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 55 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                                        () => NavigateToFamily(@adult)

#line default
#line hidden
#nullable disable
            ));
            __builder.AddMarkupContent(59, "\r\n                    <i class=\"oi oi-arrow-right\" style=\"color:red\"></i>\r\n                ");
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(60, "\r\n            \r\n                  ");
            __builder.OpenComponent<Microsoft.AspNetCore.Components.Authorization.AuthorizeView>(61);
            __builder.AddAttribute(62, "Policy", "MustBeAdmin");
            __builder.AddAttribute(63, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment<Microsoft.AspNetCore.Components.Authorization.AuthenticationState>)((context) => (__builder2) => {
                __builder2.AddMarkupContent(64, "\r\n                                   \r\n                                        ");
                __builder2.OpenElement(65, "td");
                __builder2.AddMarkupContent(66, "\r\n                                            ");
                __builder2.OpenElement(67, "button");
                __builder2.AddAttribute(68, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 62 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                                                                () => RemoveAdult(adult)

#line default
#line hidden
#nullable disable
                ));
                __builder2.AddMarkupContent(69, "\r\n                                                <i class=\"oi oi-delete\" style=\"color:red\"></i>\r\n                                            ");
                __builder2.CloseElement();
                __builder2.AddMarkupContent(70, "\r\n                                        ");
                __builder2.CloseElement();
                __builder2.AddMarkupContent(71, "\r\n                                     \r\n                                ");
            }
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(72, "\r\n\r\n            ");
            __builder.CloseElement();
            __builder.AddMarkupContent(73, "\r\n");
#nullable restore
#line 70 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
        }

#line default
#line hidden
#nullable disable
#nullable restore
#line 71 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
          foreach (var child in filteredChildren)
                {

#line default
#line hidden
#nullable disable
            __builder.AddContent(74, "                    ");
            __builder.OpenElement(75, "tr");
            __builder.AddMarkupContent(76, "\r\n                        ");
            __builder.OpenElement(77, "td");
            __builder.AddContent(78, 
#nullable restore
#line 74 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                             child.FirstName

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(79, "\r\n                        ");
            __builder.OpenElement(80, "td");
            __builder.AddContent(81, 
#nullable restore
#line 75 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                             child.LastName

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(82, "\r\n                        ");
            __builder.OpenElement(83, "td");
            __builder.AddContent(84, 
#nullable restore
#line 76 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                             child.Age

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(85, "\r\n                        ");
            __builder.OpenElement(86, "td");
            __builder.AddContent(87, 
#nullable restore
#line 77 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                             child.Sex

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(88, "\r\n                        ");
            __builder.OpenElement(89, "td");
            __builder.OpenElement(90, "button");
            __builder.AddAttribute(91, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 78 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                                                () => NavigateToFamily(@child)

#line default
#line hidden
#nullable disable
            ));
            __builder.AddMarkupContent(92, "\r\n                            <i class=\"oi oi-arrow-right\" style=\"color:red\"></i>\r\n                        ");
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(93, "\r\n                    \r\n                          ");
            __builder.OpenComponent<Microsoft.AspNetCore.Components.Authorization.AuthorizeView>(94);
            __builder.AddAttribute(95, "Policy", "MustBeAdmin");
            __builder.AddAttribute(96, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment<Microsoft.AspNetCore.Components.Authorization.AuthenticationState>)((context) => (__builder2) => {
                __builder2.AddMarkupContent(97, "\r\n                                           \r\n                                                ");
                __builder2.OpenElement(98, "td");
                __builder2.AddMarkupContent(99, "\r\n                                                    ");
                __builder2.OpenElement(100, "button");
                __builder2.AddAttribute(101, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 85 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                                                                        () => RemoveChild(child)

#line default
#line hidden
#nullable disable
                ));
                __builder2.AddMarkupContent(102, "\r\n                                                        <i class=\"oi oi-delete\" style=\"color:red\"></i>\r\n                                                    ");
                __builder2.CloseElement();
                __builder2.AddMarkupContent(103, "\r\n                                                ");
                __builder2.CloseElement();
                __builder2.AddMarkupContent(104, "\r\n                                             \r\n                                        ");
            }
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(105, "\r\n        \r\n                    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(106, "\r\n");
#nullable restore
#line 93 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
                }

#line default
#line hidden
#nullable disable
            __builder.AddContent(107, "        ");
            __builder.CloseElement();
            __builder.AddMarkupContent(108, "\r\n    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(109, "\r\n");
#nullable restore
#line 237 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
 }

#line default
#line hidden
#nullable disable
        }
        #pragma warning restore 1998
#nullable restore
#line 97 "C:\Users\natal\Desktop\DNP1-Assignment2\FamilyApp\Pages\FindMember.razor"
       
    private IList<Adult> filteredAdults;
    private IList<Child> filteredChildren;
    private IList<Family> families;
    private IList<Adult> adults;
    private IList<Child> children;
    private Adult myAdult;
    private string? byName;
    private string errorMessage = "";
    
    protected override async Task OnInitializedAsync()
    {
        adults = await MemberService.GetAdultsAsync();
        children = await MemberService.GetChildrenAsync();
        families = await FamilyService.GetFamiliesAsync();
        filteredAdults = adults;
        filteredChildren = children;
    }

    private void FilterByName(String byName)
    {
        string first = " ";
        string last = " ";


        if (byName == null)
        {
            errorMessage = "Please enter a name!";
        }
        else
        {

            if (byName.Trim().Contains(" "))
        {
            string[] words = byName.Split(' ');
            first = words[0];
            last = words[1];
        }


        if (byName == " ")
        {
            errorMessage = "Please enter a name!";
        }

        else
        {
            errorMessage = "";

    //filters people by given words-- name or lastname

            filteredChildren = children.Where(c => c.FirstName.Equals(byName.Trim(), StringComparison.OrdinalIgnoreCase)
                                                   || c.LastName.Equals(byName.Trim(), StringComparison.OrdinalIgnoreCase)
                                                   || c.FirstName.Equals(first, StringComparison.OrdinalIgnoreCase)
                                                   || c.LastName.Equals(last, StringComparison.OrdinalIgnoreCase)
                                                   || c.FirstName.Equals(last, StringComparison.OrdinalIgnoreCase)
                                                   || c.LastName.Equals(first, StringComparison.OrdinalIgnoreCase)
                ).ToList();


            filteredAdults = adults.Where(a => a.FirstName.Equals(byName.Trim(), StringComparison.OrdinalIgnoreCase)
                                               || a.LastName.Equals(byName.Trim(), StringComparison.OrdinalIgnoreCase)
                                               || a.FirstName.Equals(first, StringComparison.OrdinalIgnoreCase)
                                               || a.LastName.Equals(last, StringComparison.OrdinalIgnoreCase)
                                               || a.FirstName.Equals(last, StringComparison.OrdinalIgnoreCase)
                                               || a.LastName.Equals(first, StringComparison.OrdinalIgnoreCase)
                ).ToList();
        }
        }
    }

    
    private void RemoveAdult(Adult adult)
    {
        FamilyService.RemoveAdultFromFamilyAsync(adult);
        MemberService.RemoveAdultAsync(adult);
        adults.Remove(adult);
        filteredAdults.Remove(adult);
        byName = "";
        errorMessage = adult.FirstName + " " + adult.LastName + " has been removed.";
    }
    
    private void RemoveChild(Child child)
    {
        MemberService.RemoveChildAsync(child);
        FamilyService.RemoveChildFromFamilyAsync(child);
        children.Remove(child);
        filteredChildren.Remove(child);
        byName = "";
        errorMessage = child.FirstName + " " + child.LastName + " has been removed.";
    }

    private void NavigateToFamily(Adult adult)
    {
        List<Family> newFamilies=new List<Family>();
        foreach (var family in families)
        {
            foreach (var ad in family.Adults)
            {
                if (adult.Id == ad.Id)
                {
                    newFamilies.Add(family);
                }
            }
        }
        try
        {
            NavigationManager.NavigateTo("FamilyPage/" + newFamilies[0].StreetName+"/"+newFamilies[0].HouseNumber);
        }
        catch
        {
            errorMessage = "This member does not belong a family";
        }
    }
    
    private void NavigateToFamily(Child child)
    {
        List<Family> newFamilies=new List<Family>();
        
        foreach (var family in families)
        {
            foreach (var ch in family.Children)
            {
                if (child.Id == ch.Id)
                {
                    newFamilies.Add(family);
                }
            }
        }
        
        try
        {
            NavigationManager.NavigateTo("FamilyPage/" + newFamilies[0].StreetName+"/"+newFamilies[0].HouseNumber);
        }
        catch
        {
            errorMessage = "This member does not belong a family";
        }
   
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager NavigationManager { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IFamilyService FamilyService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IMemberService MemberService { get; set; }
    }
}
#pragma warning restore 1591
